# explore


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

``` python
data_dir = Path("../data/raw")
datasets = [
    Dataset("G214_PQ.sav", data_dir, "G214_PQ_", ["ID", "G214_PQ_PN17", "G214_PQ_PN25", "G214_PQ_PN34", "G214_PQ_PN35", "G214_PQ_PN36"]),
    Dataset("G214_SQ.sav", data_dir, "G214_SQ_", ["ID", "G214_SQ_PN17", "G214_SQ_PN25", "G214_SQ_PN34", "G214_SQ_PN35", "G214_SQ_PN36"]),
    Dataset("G217_PQ.sav", data_dir, "G217_PQ_", ["ID", "G217_PQ_PN17", "G217_PQ_PN25", "G217_PQ_PN34", "G217_PQ_PN35", "G217_PQ_PN36", "G217_PQ_PN38", "G217_PQ_PN9"]),
    Dataset("G217_SQ.sav", data_dir, "G217_SQ_", ["ID", "G217_SQ_PN17", "G217_SQ_PN25", "G217_SQ_PN34", "G217_SQ_PN35", "G217_SQ_PN36", "G217_SQ_PN38", "G217_SQ_PN9"])
]
dataframes, metadata = read_and_filter_data(datasets)
merged_df = combine_dataframes(dataframes)
merged_metadata = merge_dictionaries(metadata)
```

Define a function which takes a string and outputs a dictionary of the
unique values for all columns that match that string.

------------------------------------------------------------------------

<a
href="https://github.com/matt-humphrey/pain/blob/main/pain/explore.py#L26"
target="_blank" style="float:right; font-size:smaller">source</a>

### unique_values

>  unique_values (df:polars.lazyframe.frame.LazyFrame, pattern:str)

*Output a tuple of the unique values for each column in a given
dataframe that matches the pattern.*

------------------------------------------------------------------------

<a
href="https://github.com/matt-humphrey/pain/blob/main/pain/explore.py#L19"
target="_blank" style="float:right; font-size:smaller">source</a>

### unpack_unique_values

>  unpack_unique_values (df:polars.lazyframe.frame.LazyFrame, col:str)

*Return a tuple of the unique values for a given column in a dataframe.*

------------------------------------------------------------------------

<a
href="https://github.com/matt-humphrey/pain/blob/main/pain/explore.py#L13"
target="_blank" style="float:right; font-size:smaller">source</a>

### filter_columns

>  filter_columns (pattern:str, columns:list[str])

*Return a list of all columns that match a given regex pattern.*

``` python
unique_values(merged_df, "PN38")
```

    {'G217_PQ_PN38': (None, 0.0, 1.0, 7.0, 9.0),
     'G217_SQ_PN38': (None, 0.0, 1.0, 9.0)}

Now define a function to explore the metadata for a particular variable
across datasets. It should again take a string, and return a nested
dictionary.

------------------------------------------------------------------------

<a
href="https://github.com/matt-humphrey/pain/blob/main/pain/explore.py#L52"
target="_blank" style="float:right; font-size:smaller">source</a>

### filter_metadata

>  filter_metadata (pattern:str, df:polars.lazyframe.frame.LazyFrame,
>                       m:dict[dict[str,typing.Any]])

*Filter metadata for given columns that match the provided pattern.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>pattern</td>
<td>str</td>
<td>string or regex to filter columns,</td>
</tr>
<tr>
<td>df</td>
<td>LazyFrame</td>
<td>merged dataframe,</td>
</tr>
<tr>
<td>m</td>
<td>dict</td>
<td>merged metadata</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>dict</strong></td>
<td></td>
</tr>
</tbody>
</table>

``` python
pattern = "PN25"
filtered_metadata = filter_metadata(pattern, merged_df, merged_metadata)
pd.DataFrame(filtered_metadata).T
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">G214_PQ_PN25</th>
<th data-quarto-table-cell-role="th">G214_SQ_PN25</th>
<th data-quarto-table-cell-role="th">G217_PQ_PN25</th>
<th data-quarto-table-cell-role="th">G217_SQ_PN25</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">Label</td>
<td>Seek pro advice for back pain</td>
<td>Seek pro advice for back pain</td>
<td>Ever sought health professional advice/treatme...</td>
<td>Seek treatment for back pain?</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">Field Type</td>
<td>Numeric</td>
<td>Numeric</td>
<td>Numeric</td>
<td>Numeric</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">Field Width</td>
<td>8</td>
<td>8</td>
<td>8</td>
<td>8</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">Decimals</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">Variable Type</td>
<td>scale</td>
<td>scale</td>
<td>scale</td>
<td>scale</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">Field Values</td>
<td>{0.0: 'No', 1.0: 'Yes', 8.0: 'Not applicable',...</td>
<td>{0.0: 'No', 1.0: 'Yes', 8.0: 'Not applicable',...</td>
<td>{0.0: 'No', 1.0: 'Yes', 7.0: 'Involved in inco...</td>
<td>{0.0: 'No', 1.0: 'Yes', 9.0: 'Not stated'}</td>
</tr>
</tbody>
</table>

</div>
